2ï¸âƒ£ IAM / Permissions (this is critical for audits)

Your Python script implicitly proves security by what it can and cannot see.

AWS IAM permissions needed (read-only evidence role)

Minimum recommended policy:

{
  "Version": "2012-10-17",
  "Statement": [
    { "Effect": "Allow", "Action": [
      "rds:DescribeDBInstances",
      "ec2:DescribeTransitGateways",
      "ec2:DescribeVpnConnections",
      "ec2:DescribeRouteTables",
      "ec2:DescribeSecurityGroups"
    ], "Resource": "*" },
    { "Effect": "Allow", "Action": [
      "cloudtrail:LookupEvents"
    ], "Resource": "*" }
  ]
}


âœ… Important audit win
If cloudtrail:LookupEvents fails â†’ that failure output itself becomes evidence.

GCP IAM permissions needed

Grant a viewer-only role to the service account or user running the script:

roles/compute.viewer

roles/networkmanagement.viewer (optional but excellent)

3ï¸âƒ£ Expected directory output (this matters)

Auditors hate mixed artifacts.
Your script already does the right thing â€” you just need to preserve it.

audit-pack/
â”œâ”€â”€ tokyo/
â”‚   â”œâ”€â”€ aws_evidence.json
â”‚   â”œâ”€â”€ aws_vpn_connections.txt
â”‚   â”œâ”€â”€ aws_routes.txt
â”‚
â””â”€â”€ ny/
    â”œâ”€â”€ gcp_evidence.json
    â”œâ”€â”€ gcp_forwarding_rules.txt
    â”œâ”€â”€ gcp_firewall_rules.txt
    â”œâ”€â”€ gcp_vpn_tunnels.txt


ğŸ”‘ Rule:

Never edit these files manually.
Re-run the script to regenerate.

4ï¸âƒ£ What Terraform must output (before Python runs)

Your Python script assumes the infrastructure already exists.

Terraform must already have created:

AWS (Tokyo)

RDS instance

Transit Gateway

TGW-attached VPN

Routes pointing SP/GCP CIDRs â†’ TGW

GCP (NY / Iowa)

MIG

Internal HTTPS Load Balancer

Cloud Router

HA VPN tunnels

Firewall rules scoped to VPN CIDRs

ğŸ“Œ Recommendation
Add a Terraform output file like:

output "audit_expectations" {
  value = {
    aws_region = "ap-northeast-1"
    gcp_region = "us-central1"
    data_residency = "Tokyo only"
  }
}


This pairs design intent with runtime proof.

5ï¸âƒ£ README (this is the missing human layer)

Audits are half technical, half narrative.

Create:

audit-pack/README.md


Minimum content:

## Evidence Pack â€“ Lab 3 / Lab 4

Generated: 2026-01-14  
Generated by: malgus_collect_evidence.py

### Claims Proven
- PHI stored only in Tokyo (RDS inventory)
- Cross-region connectivity via TGW + VPN
- Private GCP access via ILB
- No public ingress paths
- Change tracking via CloudTrail

### How to Reproduce
```bash
python3 malgus_collect_evidence.py --mode both \
  --aws-profile lab \
  --gcp-project my-project


This turns the script into **career-grade documentation**.

---

## 6ï¸âƒ£ Optional but powerful upgrades (next level)

You *do not need these*, but they elevate the lab:

- âœ”ï¸ ZIP the audit-pack (`audit-pack-YYYYMMDD.zip`)
- âœ”ï¸ Hash files (`sha256sum`) for tamper evidence
- âœ”ï¸ Upload to S3 (read-only, versioned bucket)
- âœ”ï¸ Attach to Obsidian / MkDocs site

---

## ğŸ§  Final verdict

You already have:
âœ… The **hard part** (multi-cloud evidence automation)

What else was needed:
- IAM guardrails
- CLI auth
- Terraform outputs alignment
- README narrative
- Artifact discipline

Once those are in place, this is no longer â€œlab codeâ€ â€”  
itâ€™s **regulator-ready platform engineering evidence**.

If you want, next we can:
- Add **hashing + signing**
- Convert this into a **GitHub Actions audit job**
- Align outputs **line-by-line with Lab 3 / Lab 4 grading rubric**
